# Java-Refactoring

##リファクタリングとは
外部から見たプログラムの振る舞いを変えずに、プログラム内部の構造を改善する事です。  
この定義を要点は次の２つです。

- **リファクタリングを行っても、外部から見たプログラムの振る舞いは変わらない**
- **リファクタリングを行うと、プログラム内部の構造は改善する**

##リファクタリング・クイズ

###「バグとり」はリファクタリングか？
答え：いいえ

プログラムの振る舞いが変わってしまうため、リファクタリングではなない。

###「機能の追加」はリファクタリングか？
答え：いいえ

プログラムの振る舞いが変わってしまうため、リファクタリングではなない。

###「ソースコードの整理」はリファクタリングか？
答え：惜しいが、必ずしもそうではない

ソースコードを整理すると、ソースコードがよみやすくなる。
これは確かに改善の一種だが、リファクタリングとは限らない。  
なぜなら、ソースコードを整理しただけではプログラムの振る舞いが変化している可能性がある。  
リファクタリングはソースコードを整理することではない。  
かならず「外部から見たプログラムの振る舞いが変わっていない」という事を確かめながら進む。

##リファクタリングとユニットテスト
振る舞いが本当に変化していないことを、どうすれば確かめられるか。  
それは単体テスト、もしくはユニットテストを行う。  
リファクタリングを行うときには、その前後にテストを行い、振る舞いが変化していない事を確かめる。

- リファクタリング前にテスト
- リファクタリングを行う
- リファクタリング後に再度テスト

リファクタリングにテストは必須、JUnitを使ってもいい。

##リファクタリングの目的

###バグを見つけやすくする
プログラムが整理され、バグが見つけやすくなる。  
混乱したコードはデバッグしにくい。

###機能追加しやすくなる
一般に、機能追加を重ねるとソースコードは複雑になっていくため、後の機能追加が難しくなり、余計に時間に追われるという悪循環になる。

###レビューしやすくなる
コードレビューがしやすくなる。  
リファクタリングを行ってきれいにしたコードは読みやすく、理解しやすくなる

##リファクタリングの限界
リファクタリングはいつでもできるわけではなく、リファクタリングを適用できない場合もある

###プログラムがまだ動いていない場合
作りかけで動いていないプログラムはリファクタリングできない。  
まずは動くプログラムをつくろう。
同様に、設計やコーディングがまずく、バグだらけで使えないプログラムに対してもリファクタリングはできない。

###あまりにも時間がない場合
納期が厳しいときにリファクタリングするのは懸命ではない。  
リファクタリングの効果というのは、時間的に少し後からじわじわ効いてくるものである。  
納期直前に大きなリファクタリングはやめる
